"use strict";

import VectorSource from "ol/source/Vector";
import VectorLayer from "ol/layer/Vector";
import EsriJSON from "ol/format/EsriJSON";

const esrijsonformat = new EsriJSON();

export function layer(map) {
    let source = _source(map);

    let layer = new VectorLayer({
        visible: false,
        source: source
    });
    layer.set("name", "vulnerability_ribbon");

    map.on("render_vulnerability_ribbon", ({data}) => {
        let features = esrijsonformat.readFeaturesFromObject(data);
        if (features.length > 0) {
            source.addFeatures(features);
            layer.setVisible(true);
        } else {
            source.clear();
            layer.setVisible(false);
        }
    });

    return layer;
}

function _source(map) {
    let source = new VectorSource();
    return source;

}

